<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team1.healthcare.dao.DiagnosisDAO">
	<select id="selectDiagnosisListByMemberId" parameterType="int"
		resultType="diagnosis">
		select diag_id, week_no, start_date, end_date,
		visit_purpose, dr_opinion, is_pharmacy, is_injector,
		is_diagnostic_test, is_vital, reservation_status, member_id,
		patient_id
		from diagnosis
		where member_id=#{memberId}
	</select>

	<select id="getCompletedDiagnosisListByPatientId"
		parameterType="int" resultType="diagnosis">
		select diag_id, week_no, start_date,
		end_date,
		visit_purpose, dr_opinion, is_pharmacy, is_injector,
		is_diagnostic_test, is_vital, reservation_status, member_id,
		patient_id
		from diagnosis
		where patient_id = #{patientId} and
		reservation_status = 'RESERVATION_COMPLETED'
		order by diag_id DESC
	</select>

	<update id="addDiagnosisInfo"
		parameterType="registDiagnosisResult">
		update diagnosis set
		dr_opinion = #{drOpinion},
		is_pharmacy = #{isPharmacy},
		is_injector = #{isInjector},
		is_diagnostic_test = #{isDiagnosticTest},
		is_vital = #{isVital}
		where
		diag_id = #{diagId}
	</update>
</mapper>