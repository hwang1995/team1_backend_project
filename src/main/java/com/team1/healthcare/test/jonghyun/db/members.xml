<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team1.healthcare.test.jonghyun.dao.MembersDAO">


	<!-- <typeAliases> <typeAlias type="MembersDTO패키지" alias="MembersDTO"/> </typeAliases> -->

	<select id="getMembersList" resultType="members">
		select *
		from members
		order by memberId desc
	</select>
	
	<select id="getMembersKeywordList" parameterType="String" resultType="members">
		select *
		from members
		where memberName like '%${keyword}%'
		order by memberId desc
	</select>

	<!-- 이메일 중복체크를 위한 쿼리문 
		 1 이상이면 이메일 중복 -->
	<select id="checkEmail" parameterType="String" resultType="int">
		select count(*)
		from members
		where memberEmail=#{memberEmail}
	</select>
	
	<select id="countMember" resultType="int">
		select count(*) from members
	</select>
	
	<insert id="createMember" parameterType="members">
		insert into 
		members(memberEmail, memberPw, member_name, member_tel, member_addr1,
				member_addr2, member_postal, member_authority, member_enabled, 
				hospital_code, member_gender, member_birth, joined_date, member_color)
		values(#{member_email}, #{member_pw}, #{member_name}, #{member_tel}, #{member_addr1},
				#{member_addr2}, #{member_postal}, #{member_authority}, 1,
				#{hospital_code}, #{member_gender}, #{member_birth}, now(), #{member_color});
	</insert>
	
	<update id="updateMember" parameterType="members">
		update members
		set memberAuthority=#{memberAuthority},
			memberName=#{memberName},
			memberTel=#{memberTel},
			memberPostal=#{memberPostal},
			memberAddr1=#{memberAddr1},
			memberAddr2=#{memberAddr2}
		where memberId=#{memberId}
	</update>
	
	<update id="initialPWMember" parameterType="int">
		update members
		set memberPW='douzone123!'
		where memberId=#{memberId}
	</update>
	
	<delete id="deleteMember" parameterType="int">
		delete from members where memberId=#{memberId}
	</delete>
</mapper>